function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}document.querySelector(".game-max-score").textContent=localStorage.getItem("score")||0,new(function(){var t,a;function r(){var e=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,r),this.TILE_CLASSES={0:"",2:"field-cell--2",4:"field-cell--4",8:"field-cell--8",16:"field-cell--16",32:"field-cell--32",64:"field-cell--64",128:"field-cell--128",256:"field-cell--256",512:"field-cell--512",1024:"field-cell--1024",2048:"field-cell--2048"},this.GRID_SIZE=4,this.data=Array.from({length:this.GRID_SIZE},function(){return Array(e.GRID_SIZE).fill(0)}),this.score=0,this.inProgress=!1,this.startButton=document.querySelector(".start"),this.messageWin=document.querySelector(".message-win"),this.messageStart=document.querySelector(".message-start"),this.messageLose=document.querySelector(".message-lose"),this.gameScoreBlock=document.querySelector(".game-score"),this.fieldRows=document.querySelectorAll(".field-row"),document.querySelector(".game-max-score").textContent=this.getMaxScore(),this.startButton.addEventListener("click",function(){return e.handleStartClick()}),document.addEventListener("keydown",function(t){return e.handleKeyPress(t)})}return t=[{key:"handleStartClick",value:function(){"Start"===this.startButton.innerText?this.startGame():this.restartGame()}},{key:"startGame",value:function(){this.startButton.innerText="Restart",this.startButton.classList.replace("start","restart"),this.messageStart.classList.add("hidden"),this.clearField(),this.randomizer(2),this.inProgress=!0,this.domReload()}},{key:"getMaxScore",value:function(){return localStorage.getItem("score")||0}},{key:"restartGame",value:function(){this.clearField(),this.saveMaxScore(),this.score=0,this.messageLose.classList.add("hidden"),this.messageWin.classList.add("hidden"),this.startGame()}},{key:"handleKeyPress",value:function(e){if(this.inProgress){var t=JSON.parse(JSON.stringify(this.data)),a=!1;switch(e.key){case"ArrowRight":a=this.makeMove("right");break;case"ArrowLeft":a=this.makeMove("left");break;case"ArrowDown":a=this.makeMove("down");break;case"ArrowUp":a=this.makeMove("up")}a&&!this.isEqual(t,this.data)&&(this.randomizer(1),this.isGameOver()?this.endGame():this.domReload())}}},{key:"makeMove",value:function(e){return!this.isGameOver()&&(this.mergeTiles(e),this.tileMovement(e),this.isWin(),!0)}},{key:"endGame",value:function(){this.inProgress=!1,this.messageLose.classList.remove("hidden"),this.domReload()}},{key:"isEqual",value:function(e,t){return JSON.stringify(e)===JSON.stringify(t)}},{key:"tileMovement",value:function(e){for(var t=0;t<this.data.length;t++){var a=void 0;"right"===e||"left"===e?(a=this.getHorizontalValues(t,e),this.data[t]=a):("down"===e||"up"===e)&&(a=this.getVerticalValues(t,e),this.data=this.updateDataArray(this.data,a,e,t))}}},{key:"getHorizontalValues",value:function(e,t){var a=this.data[e].filter(function(e){return 0!==e}),r=this.data[e].filter(function(e){return 0===e});return"right"===t?r.concat(a):a.concat(r)}},{key:"getVerticalValues",value:function(e,t){var a=this.data.map(function(t){return t[e]}),r=a.filter(function(e){return 0!==e}),i=a.filter(function(e){return 0===e});return"down"===t?i.concat(r):r.concat(i)}},{key:"mergeTiles",value:function(e){for(var t=this,a=0;a<this.data.length;a++)!function(a){var r=t.getValues(e,a),i=Array(t.data.length).fill(!1),s=r.filter(function(e){return 0!==e}),n=r.filter(function(e){return 0===e});if("down"===e||"right"===e){for(var o=s.length-1;o>0;o--)t.mergeAdjacentTiles(o,s,i);t.data=t.updateDataArray(t.data,n.concat(s),e,a)}else if("up"===e||"left"===e){for(var l=0;l<s.length-1;l++)t.mergeAdjacentTiles(l,s,i);t.data=t.updateDataArray(t.data,s.concat(n),e,a)}}(a)}},{key:"mergeAdjacentTiles",value:function(e,t,a){t[e]!==t[e-1]||a[e]||(t[e]+=t[e-1],this.score+=t[e],t[e-1]=0,a[e]=!0)}},{key:"getValues",value:function(e,t){return"down"===e||"up"===e?this.data.map(function(e){return e[t]}):this.data[t].slice()}},{key:"updateDataArray",value:function(e,t,a,r){if("down"===a||"up"===a)for(var i=0;i<e.length;i++)e[i][r]=t[i];else("left"===a||"right"===a)&&(e[r]=t.slice());return e}},{key:"randomizer",value:function(e){for(var t=0;t<e;t++){var a=this.getEmptyPositions();if(a.length>0){var r=Math.floor(Math.random()*a.length),i=a[r],s=i.row,n=i.tile;this.data[s][n]=2*Math.random()>1.9?4:2}}}},{key:"getEmptyPositions",value:function(){for(var e=[],t=0;t<this.data.length;t++)for(var a=0;a<this.data[t].length;a++)0===this.data[t][a]&&e.push({row:t,tile:a});return e}},{key:"colorizing",value:function(){var e=this;this.fieldRows.forEach(function(t,a){var r=t.querySelectorAll(".field-cell");e.data[a].forEach(function(t,a){r[a].className="field-cell ".concat(e.TILE_CLASSES[t])})})}},{key:"isWin",value:function(){this.data.some(function(e){return e.includes(2048)})&&(this.messageWin.classList.remove("hidden"),this.inProgress=!1)}},{key:"clearField",value:function(){var e=this;this.data=Array.from({length:this.GRID_SIZE},function(){return Array(e.GRID_SIZE).fill(0)})}},{key:"domReload",value:function(){var e=this;this.fieldRows.forEach(function(t,a){var r=t.querySelectorAll(".field-cell");e.data[a].forEach(function(e,t){r[t].textContent=0===e?" ":e})}),this.gameScoreBlock.textContent=this.score,this.colorizing()}},{key:"saveMaxScore",value:function(){this.score>localStorage.getItem("score")&&localStorage.setItem("score",this.score)}},{key:"cycle",value:function(e){for(var t=0;t<this.data.length;t++)if(e){for(var a=0;a<this.data[t].length-1;a++)if(this.data[t][a]===this.data[t][a+1]||0===this.data[t][a])return!1}else for(var r=0;r<this.data[t].length;r++)if(t<this.data.length-1&&(this.data[t][r]===this.data[t+1][r]||0===this.data[t][r]))return!1;return!0}},{key:"isGameOver",value:function(){return!!(!this.data.some(function(e){return e.includes(0)})&&this.cycle(!0)&&this.cycle(!1))&&(this.saveMaxScore(),localStorage.setItem("score",this.score),!0)}}],e(r.prototype,t),a&&e(r,a),r}());
//# sourceMappingURL=index.ab88968d.js.map
